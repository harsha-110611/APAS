<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Flash Card Quiz</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  overflow: hidden;
  background: black;
  font-family: Arial, sans-serif;
}
canvas#circuit {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  display: block;
  z-index: 0;
}
#quiz-container {
  position: relative;
  z-index: 100;
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  color: white;
  text-align: center;
}
#question {
  font-size: 26px;
  margin-bottom: 50px;
  max-width: 80%;
  min-height: 70px;
}
#timer {
  position: absolute;
  top: 15px;
  right: 20px;
  font-size: 24px;
  font-weight: bold;
  color: #ff4444;
}
.options {
      display: flex;
      gap: 40px;
      perspective: 1000px;
      justify-content: center;
      z-index: 2;
    }
.card {
  width: 200px;
  height: 260px;
  position: relative;
  cursor: pointer;
  transform-style: preserve-3d;
  transition: transform 0.6s;
}
.card.flipped {
  transform: rotateY(180deg);
}
.card .face {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  border-radius: 14px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 20px;
  font-weight: bold;
  box-shadow: 0 4px 10px rgba(0,0,0,0.25);
  padding: 10px;
  text-align: center;
}
.front {
  background: rgba(255,255,255,0.9);
  border: 2px solid #0077ff;
  color: #0077ff;
}
.back {
  background: #0077ff;
  color: white;
  transform: rotateY(180deg);
}
.fall {
  animation: fallDown 0.8s forwards;
}
@keyframes fallDown {
  to { transform: translateY(450px) rotate(25deg); opacity: 0; }
}
#score {
  position: fixed;
  bottom: 90px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 20px;
  font-weight: bold;
  color: white;
}


    #playAgainBtn {
      position: relative;
      padding:0.5rem 1.25rem;
      border-radius:9999px;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      font-weight:bold;
      border:3px solid #ffffff4d;
      background-color: rgb(0 107 179);
      color:#fff;
      cursor:pointer;
      overflow:hidden;
      font-size:15px;
      transition: all 0.3s ease-in-out;
      margin-top: 30px;
    }
    #playAgainBtn:hover {
      transform:scale(1.05);
      border-color:#fff9;
    }
    #playAgainBtn::before {
      content:"";
      position:absolute;
      width:100px;
      height:100%;
      background:linear-gradient(120deg, rgba(255,255,255,0) 30%, rgba(255,255,255,0.8), rgba(255,255,255,0) 70%);
      top:0;
      left:-100px;
      opacity:0.6;
      pointer-events:none;
    }
    #playAgainBtn:hover::before {
      animation: shine 1.5s ease-out infinite;
    }
    @keyframes shine {
      0% { left:-100px; }
      100% { left:100%; }
    }
</style>
</head>
<body>
<canvas id="circuit"></canvas>
<div id="quiz-container">
   <div id="timer">15</div>
  <div id="question">Loading Question...</div>
  <div class="options" id="options"></div>
  <div id="score">Score: 0 | Attempts: 0</div>
  <div id="playAgainContainer" style="display:none; z-index:2;">
    <button id="playAgainBtn" onclick="goToDepartments()">Play Again</button>
</div>
<script>
/* ================== Circuit Background ================== */
const canvas = document.getElementById("circuit");
const ctx = canvas.getContext("2d");
let width, height;
function resize() {
  width=canvas.width=window.innerWidth; 
  height=canvas.height=window.innerHeight;
}
window.addEventListener("resize", resize);
resize();
const cursor={x:width/2,y:height/2};
window.addEventListener("mousemove", e=>{cursor.x=e.clientX;cursor.y=e.clientY;});
const spacing=80, nodes=[];
for(let x=0;x<width;x+=spacing) 
  for(let y=0;y<height;y+=spacing) nodes.push({x,y});
const sparks=[];
function createSpark(x,y){ sparks.push({x,y,vx:(Math.random()<0.5?spacing:-spacing),vy:(Math.random()<0.5?spacing:-spacing),life:15+Math.random()*25}); }
let hue=Math.random()*360;
function nextColor(){ hue+=0.6; return `hsl(${hue%360},100%,50%)`; }
function draw(){
  ctx.fillStyle="rgba(0,0,0,0.25)";
  ctx.fillRect(0,0,width,height);
  const color=nextColor();
  ctx.strokeStyle=color;
  nodes.forEach(n=>{
    if(n.x+spacing<width){ ctx.beginPath(); ctx.moveTo(n.x,n.y); ctx.lineTo(n.x+spacing,n.y); ctx.stroke(); }
    if(n.y+spacing<height){ ctx.beginPath(); ctx.moveTo(n.x,n.y); ctx.lineTo(n.x,n.y+spacing); ctx.stroke(); }
  });
  for(let i=sparks.length-1;i>=0;i--){
    const s=sparks[i];
    const glow=ctx.createRadialGradient(s.x,s.y,0,s.x,s.y,12);
    glow.addColorStop(0,color); glow.addColorStop(1,"rgba(0,0,0,0)");
    ctx.fillStyle=glow;
    ctx.beginPath(); ctx.arc(s.x,s.y,6,0,Math.PI*2); ctx.fill();
    s.x+=Math.sign(s.vx)*4; s.y+=Math.sign(s.vy)*4; s.life--;
    if(s.life<=0) sparks.splice(i,1);
  }
  if(Math.random()<0.3){
    let nearest=null,min=Infinity;
    nodes.forEach(n=>{
      const dx=n.x-cursor.x,dy=n.y-cursor.y,d=dx*dx+dy*dy;
      if(d<min){ min=d; nearest=n; }
    });
    if(nearest) createSpark(nearest.x,nearest.y);
  }
  requestAnimationFrame(draw);
}
draw();

/* ================== Quiz Logic ================== */
const easyQuestions = [
  {text:"What does ECE stand for?",options:["Electronics and Communication Engineering","Electrical and Civil Engineering","Electronic Computer Engineering","Engineering Circuit Electronics"],correct:0},
  {text:"What is the basic unit of current?",options:["Ampere","Volt","Ohm","Watt"],correct:0},
  {text:"What is the unit of resistance?",options:["Ohm","Ampere","Volt","Watt"],correct:0},
  {text:"Which device converts AC to DC?",options:["Rectifier","Transformer","Capacitor","Inductor"],correct:0},
  {text:"Which device stores electrical energy?",options:["Capacitor","Resistor","Inductor","Diode"],correct:0},
  {text:"Which component allows current to flow in one direction?",options:["Diode","Resistor","Capacitor","Transistor"],correct:0},
  {text:"Which is a semiconductor material?",options:["Silicon","Copper","Aluminum","Iron"],correct:0},
  {text:"Which device amplifies current?",options:["Transistor","Diode","Resistor","Capacitor"],correct:0},
  {text:"What is the symbol for resistor in a circuit?",options:["Zigzag line","Straight line","Triangle","Circle"],correct:0},
  {text:"Which wave carries radio signals?",options:["Electromagnetic wave","Sound wave","Mechanical wave","Water wave"],correct:0},
  {text:"Which law relates voltage, current, and resistance?",options:["Ohm's Law","Kirchhoff's Law","Faraday's Law","Coulomb's Law"],correct:0},
  {text:"Which device is used to measure voltage?",options:["Voltmeter","Ammeter","Wattmeter","Galvanometer"],correct:0},
  {text:"Which logic gate gives output HIGH only when all inputs are HIGH?",options:["AND","OR","NOT","NAND"],correct:0},
  {text:"Which component opposes current flow?",options:["Resistor","Diode","Capacitor","Inductor"],correct:0},
  {text:"Which device is used to step up voltage?",options:["Transformer","Rectifier","Diode","Transistor"],correct:0}
];
const mediumQuestions = [
  {text:"Which type of transistor is widely used in amplification?",options:["BJT","FET","MOSFET","All of these"],correct:0},
  {text:"Which filter allows high frequency signals to pass?",options:["High-pass filter","Low-pass filter","Band-pass filter","Notch filter"],correct:0},
  {text:"Which modulation is used in FM radio?",options:["Frequency Modulation","Amplitude Modulation","Pulse Modulation","Phase Modulation"],correct:0},
  {text:"What is the function of an op-amp?",options:["Amplification","Rectification","Switching","Timing"],correct:0},
  {text:"Which law is used for loop analysis in circuits?",options:["Kirchhoff's Voltage Law","Ohm's Law","Faraday's Law","Coulomb's Law"],correct:0},
  {text:"Which component stores energy in magnetic field?",options:["Inductor","Capacitor","Resistor","Diode"],correct:0},
  {text:"Which is a digital signal?",options:["Square wave","Sine wave","Triangle wave","Sawtooth wave"],correct:0},
  {text:"Which technique is used to reduce noise in communication?",options:["Shielding","Amplification","Rectification","Modulation"],correct:0},
  {text:"Which device converts digital signal to analog?",options:["DAC","ADC","Transistor","Op-amp"],correct:0},
  {text:"Which is used to store binary data temporarily?",options:["Flip-flop","Diode","Resistor","Capacitor"],correct:0}
];
const hardQuestions = [
  {text:"Which modulation is more resistant to noise?",options:["Frequency Modulation","Amplitude Modulation","Pulse Modulation","Phase Modulation"],correct:0},
  {text:"What is the gain of an ideal op-amp in open loop?",options:["Infinity","1","0","100"],correct:0},
  {text:"Which method is used for error detection in digital communication?",options:["Parity check","Amplification","Modulation","Filtering"],correct:0},
  {text:"Which type of memory is volatile and fast?",options:["SRAM","ROM","EEPROM","Flash"],correct:0},
  {text:"Which filter allows a specific frequency range to pass?",options:["Band-pass filter","Low-pass filter","High-pass filter","Notch filter"],correct:0}
];
function pickRandom(arr, n) {
      const copy = [...arr];
      const result = [];
      for (let i = 0; i < n && copy.length > 0; i++) {
        const index = Math.floor(Math.random() * copy.length);
        result.push(copy.splice(index, 1)[0]);
      }
      return result;
    }

    const questions = [
      ...pickRandom(easyQuestions, 2),
      ...pickRandom(mediumQuestions, 2),
      ...pickRandom(hardQuestions, 1)
    ];

    let currentIndex = 0;
    let score = 0;
    let attempts = 0;
    let timer;
    let timeLeft = 15;
    let answered = false;

    const questionEl = document.getElementById("question");
    const optionsEl = document.getElementById("options");
    const scoreEl = document.getElementById("score");
    const timerEl = document.getElementById("timer");
    const playAgainContainer = document.getElementById("playAgainContainer");
const prevScore = localStorage.getItem("civilQuizScore");
const prevAttempts = localStorage.getItem("civilQuizAttempts");

if (prevScore && prevAttempts) {
  scoreEl.textContent = `Last Score: ${prevScore} | Attempts: ${prevAttempts}`;
}
function shuffleArray(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

    // ===== Timer =====
    function startTimer() {
      clearInterval(timer);
      timeLeft = 15;
      timerEl.textContent = timeLeft;
      timer = setInterval(() => {
        timeLeft--;
        timerEl.textContent = timeLeft;
       if (timeLeft <= 0) {
  clearInterval(timer);

  if (!answered) {
    answered = true;
    attempts++;
    scoreEl.textContent = `Score: ${score} | Attempts: ${attempts}`;
    showCorrectAnswer();
    setTimeout(nextQuestion, 1500);
  }
}
      }, 1000);
    }
function shuffleOptions(question) {
  const optionsWithIndex = question.options.map((opt, i) => ({
    text: opt,
    isCorrect: i === question.correct
  }));

  // Fisherâ€“Yates shuffle
  for (let i = optionsWithIndex.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [optionsWithIndex[i], optionsWithIndex[j]] =
    [optionsWithIndex[j], optionsWithIndex[i]];
  }

  question.options = optionsWithIndex.map(o => o.text);
  question.correct = optionsWithIndex.findIndex(o => o.isCorrect);
}

    // ===== Load Question =====
    function loadQuestion() {
      answered = false;
      const q = questions[currentIndex];
      shuffleOptions(q);
      optionsEl.innerHTML = "";
      questionEl.textContent = q.text;
      q.options.forEach((opt, i) => {
        const card = document.createElement("div");
        card.className = "card";
        const front = document.createElement("div");
        front.className = "face front";
        front.textContent = opt;
        const back = document.createElement("div");
        back.className = "face back";
        back.textContent = (i === q.correct) ? "Correct!" : "Wrong!";
        card.appendChild(front);
        card.appendChild(back);
        card.addEventListener("click", () => selectOption(card, i));
        optionsEl.appendChild(card);
      });
      startTimer();
    }
function showCorrectAnswer() {
  const q = questions[currentIndex];
  const cards = document.querySelectorAll(".card");

  cards.forEach((card, i) => {
    card.classList.add("flipped");
    const back = card.querySelector(".back");

    if (i === q.correct) {
      back.style.background = "green";
      back.textContent = "Correct!";
    } else {
      back.style.background = "red";
      back.textContent = "Wrong!";
    }
  });
}

    // ===== Select Option =====
function selectOption(selectedCard, index) {
  if (answered) return;
  answered = true;

  clearInterval(timer);
  attempts++;

  const correctIndex = questions[currentIndex].correct;
  if (index === correctIndex) score += 2;

  scoreEl.textContent = `Score: ${score} | Attempts: ${attempts}`;

  showCorrectAnswer();
  setTimeout(nextQuestion, 1500);
}


    // ===== Next Question =====
   function nextQuestion() {
  currentIndex++;

  if (currentIndex < questions.length) {
    loadQuestion();
  } else {
    questionEl.textContent =
      `Quiz Finished!
Final Score: ${score}
Attempts: ${attempts}`;

    optionsEl.innerHTML = "";
    timerEl.textContent = "";

    // ðŸ‘‡ SAVE DATA
    localStorage.setItem("civilQuizScore", score);
    localStorage.setItem("civilQuizAttempts", attempts);

    playAgainContainer.style.display = "block";
  }
}

    // ===== Go to Departments =====
    function goToDepartments() {
      window.location.href = "departments.html";
    }

    // ===== Start Quiz =====
    loadQuestion();
  </script>
</body>
</html>
