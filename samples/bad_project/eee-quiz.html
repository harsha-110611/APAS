<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flash Card Quiz</title>
<style>
  * { box-sizing: border-box; margin:0; padding:0; }

  body {
    margin: 0;
    overflow: hidden;
    background: #0c0c0c;
    font-family: 'Poppins', Arial, sans-serif;
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    position: relative;
  }

  canvas { position:absolute; top:0; left:0; z-index:0; }

  #question {
    font-size: 26px;
    margin-bottom: 50px;
    text-align: center;
    max-width: 80%;
    min-height: 70px;
    z-index: 2;
    position: relative;
  }

  #timer {
    position: absolute;
    top: 15px;
    right: 20px;
    font-size: 24px;
    font-weight: bold;
    color: #ff4444;
    z-index: 2;
  }

.options {
      display: flex;
      gap: 30px;
      perspective: 1000px;
      justify-content: center;
      z-index: 2;
    }

  .card {
    width: 200px;
    height: 260px;
    position: relative;
    cursor: pointer;
    transform-style: preserve-3d;
    transition: transform 0.6s;
    z-index: 2;
    background:#000;
    color: #fff;
  }
  .card.flipped { transform: rotateY(180deg); }

  .card .face {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 20px;
    font-weight: bold;
    box-shadow: 0 4px 10px rgba(0,0,0,0.25);
    padding: 10px;
    text-align: center;
  }
  .front {
    background: #ffffff;
    border: 2px solid #0077ff;
    color: #0077ff;
  }
  .back {
    background: #0077ff;
    color: white;
    transform: rotateY(180deg);
  }

  #score {
    position: fixed;
    bottom: 40px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 20px;
    font-weight: bold;
    color: #fff;
    z-index: 2;
  }

  #playAgainBtn {
    position: relative;
    padding:0.5rem 1.25rem;
    border-radius:9999px;
    display:flex;
    align-items:center;
    justify-content:center;
    gap:10px;
    font-weight:bold;
    border:3px solid #ffffff4d;
    background-color: rgb(0 107 179);
    color:#fff;
    cursor:pointer;
    overflow:hidden;
    font-size:15px;
    transition: all 0.3s ease-in-out;
    margin-top: 30px;
    z-index: 2;
  }
  #playAgainBtn:hover {
    transform:scale(1.05);
    border-color:#fff9;
  }
  #playAgainBtn::before {
    content:"";
    position:absolute;
    width:100px;
    height:100%;
    background:linear-gradient(120deg, rgba(255,255,255,0) 30%, rgba(255,255,255,0.8), rgba(255,255,255,0) 70%);
    top:0;
    left:-100px;
    opacity:0.6;
    pointer-events:none;
  }
  #playAgainBtn:hover::before {
    animation: shine 1.5s ease-out infinite;
  }
  @keyframes shine { 0% { left:-100px; } 100% { left:100%; } }
  .fall {
  animation: fallDown 0.8s forwards;
}
@keyframes fallDown {
  to {
    transform: translateY(450px) rotate(25deg);
    opacity: 0;
  }
}

</style>
</head>
<body>

  <canvas id="c"></canvas>
  <div id="timer">15</div>
  <div id="question">Loading Question...</div>
  <div class="options" id="options"></div>
  <div id="score">Score: 0</div>
<div id="playAgainContainer" style="display:none;">
  <button id="playAgainBtn" onclick="goToDepartments()">Play Again</button>
</div>


  <!-- Thunder sound -->
  <audio id="thunderSound" src="https://www.soundjay.com/nature/thunder-01.mp3"></audio>

<script>
  // ==== Lightning background ====
  const canvas = document.getElementById("c"), ctx = canvas.getContext("2d");
  let width, height;
  function resize(){ width=canvas.width=window.innerWidth; height=canvas.height=window.innerHeight; }
  window.addEventListener("resize", resize);
  resize();

  const cfg={segmentLen:18,jag:25,life:15,flashAlpha:0.25};
  let bolts=[], flash=0;

  function makeBolt(x1,y1,x2,y2){
    const segments=[{x:x1,y:y1}];
    let curX=x1, curY=y1;
    const dx=x2-x1, dy=y2-y1, steps=Math.hypot(dx,dy)/cfg.segmentLen;
    for(let i=0;i<steps;i++){
      curX+=dx/steps+(Math.random()-0.5)*cfg.jag;
      curY+=dy/steps+(Math.random()-0.5)*cfg.jag;
      segments.push({x:curX,y:curY});
    }
    segments.push({x:x2,y:y2});
    return {segments,life:cfg.life};
  }

  function strikeAt(x,y){
    const angle=Math.random()*Math.PI*2,radius=150;
    const sx=x+Math.cos(angle)*radius, sy=y+Math.sin(angle)*radius;
    bolts.push(makeBolt(sx,sy,x,y));
  }

  function drawBolt(bolt,alpha){
    ctx.save(); ctx.globalCompositeOperation="lighter";
    ctx.lineWidth=6; ctx.shadowBlur=25; ctx.shadowColor="rgba(255,200,50,1)";
    ctx.beginPath(); ctx.moveTo(bolt.segments[0].x,bolt.segments[0].y);
    bolt.segments.forEach(p=>ctx.lineTo(p.x,p.y));
    ctx.strokeStyle=`rgba(255,200,50,${0.5*alpha})`; ctx.stroke();
    ctx.lineWidth=3; ctx.shadowBlur=10; ctx.shadowColor="rgba(255,230,100,1)";
    ctx.beginPath(); ctx.moveTo(bolt.segments[0].x,bolt.segments[0].y);
    bolt.segments.forEach(p=>ctx.lineTo(p.x,p.y));
    ctx.strokeStyle=`rgba(255,230,100,${0.9*alpha})`; ctx.stroke();
    ctx.lineWidth=1.5; ctx.shadowBlur=0;
    ctx.beginPath(); ctx.moveTo(bolt.segments[0].x,bolt.segments[0].y);
    bolt.segments.forEach(p=>ctx.lineTo(p.x,p.y));
    ctx.strokeStyle=`rgba(255,255,255,${1*alpha})`; ctx.stroke();
    ctx.restore();
  }

  function loop(){
    ctx.fillStyle="rgba(0,0,0,0.3)"; ctx.fillRect(0,0,width,height);
    bolts.forEach((b,i)=>{
      const alpha=b.life/cfg.life;
      drawBolt(b,alpha);
      b.life--;
      if(b.life<=0) bolts.splice(i,1);
    });
    if(flash>0){ ctx.fillStyle=`rgba(255,255,200,${flash})`; ctx.fillRect(0,0,width,height); flash-=0.02; }
    requestAnimationFrame(loop);
  }
  loop();

  const thunderSound = document.getElementById("thunderSound");
  canvas.addEventListener("mousemove", e=>{
    strikeAt(e.clientX,e.clientY);
    flash=cfg.flashAlpha;
    thunderSound.currentTime=0;
    thunderSound.play();
  });

  // ==== Quiz ====
const easyQuestions = [
  { text:"What does EEE stand for?", options:["Electrical and Electronics Engineering","Energy and Environment Engineering","Electronic Equipment Engineering","Embedded Electrical Engineering"], correct:0 },
  { text:"Which law states that V = IR?", options:["Ohmâ€™s Law","Kirchhoffâ€™s Law","Faradayâ€™s Law","Lenzâ€™s Law"], correct:0 },
  { text:"Which device stores electrical energy?", options:["Capacitor","Resistor","Inductor","Diode"], correct:0 },
  { text:"Which machine converts electrical energy into mechanical energy?", options:["Motor","Generator","Transformer","Rectifier"], correct:0 },
  { text:"What does AC stand for?", options:["Alternating Current","Absolute Current","Active Current","Additional Current"], correct:0 },
  { text:"What is the SI unit of resistance?", options:["Ohm","Volt","Ampere","Watt"], correct:0 },
  { text:"Which device converts AC to DC?", options:["Rectifier","Transformer","Inverter","Amplifier"], correct:0 },
  { text:"Which law is used in electromagnetic induction?", options:["Faradayâ€™s Law","Ohmâ€™s Law","Coulombâ€™s Law","Gaussâ€™s Law"], correct:0 },
  { text:"Which element is widely used as a semiconductor?", options:["Silicon","Copper","Aluminum","Iron"], correct:0 },
  { text:"Which unit is used for measuring electric current?", options:["Ampere","Volt","Ohm","Watt"], correct:0 },
  { text:"Which instrument measures electric potential difference?", options:["Voltmeter","Ammeter","Wattmeter","Ohmmeter"], correct:0 },
  { text:"Which device increases or decreases AC voltage?", options:["Transformer","Rectifier","Inverter","Motor"], correct:0 },
  { text:"What does LED stand for?", options:["Light Emitting Diode","Low Energy Device","Linear Electric Device","Light Energy Diode"], correct:0 },
  { text:"What is the frequency of AC supply in India?", options:["50 Hz","60 Hz","100 Hz","120 Hz"], correct:0 },
  { text:"Which charge carriers flow in a conductor?", options:["Electrons","Protons","Neutrons","Photons"], correct:0 }
];

const mediumQuestions = [
  { text:"Which theorem is used to simplify electrical networks?", options:["Theveninâ€™s Theorem","Ohmâ€™s Law","Faradayâ€™s Law","Gaussâ€™s Law"], correct:0 },
  { text:"What is the power factor of a purely resistive circuit?", options:["1","0","0.5","-1"], correct:0 },
  { text:"Which device is used for power factor correction?", options:["Capacitor Bank","Inductor","Transformer","Resistor"], correct:0 },
  { text:"Which loss occurs in a transformer due to alternating flux?", options:["Eddy Current Loss","Copper Loss","Hysteresis Loss","Dielectric Loss"], correct:0 },
  { text:"Which machine converts mechanical energy to electrical energy?", options:["Generator","Motor","Rectifier","Transformer"], correct:0 },
  { text:"Which motor is widely used in household fans?", options:["Single Phase Induction Motor","DC Motor","Synchronous Motor","Universal Motor"], correct:0 },
  { text:"Which principle does a transformer work on?", options:["Mutual Induction","Self Induction","Electrostatics","Electrolysis"], correct:0 },
  { text:"Which law explains direction of induced emf?", options:["Lenzâ€™s Law","Ohmâ€™s Law","Kirchhoffâ€™s Law","Gaussâ€™s Law"], correct:0 },
  { text:"Which type of current is used for long-distance power transmission?", options:["AC","DC","Both AC & DC","Pulsed DC"], correct:0 },
  { text:"Which component opposes change in current?", options:["Inductor","Capacitor","Resistor","Diode"], correct:0 }
];

const hardQuestions = [
  { text:"What is the main advantage of HVDC transmission?", options:["Low transmission losses","High insulation cost","Complex converters","High frequency use"], correct:0 },
  { text:"Which stability is improved by using synchronous condensers?", options:["Voltage Stability","Thermal Stability","Dynamic Stability","Mechanical Stability"], correct:0 },
  { text:"Which factor determines skin effect in conductors?", options:["Frequency","Resistance","Capacitance","Length"], correct:0 },
  { text:"Which control method is used in modern power systems for frequency regulation?", options:["Automatic Generation Control","Load Shedding","Transformer Tap Changing","Reactive Power Compensation"], correct:0 },
  { text:"Which protection device isolates a faulty section in transmission lines?", options:["Circuit Breaker","Relay","Fuse","Isolator"], correct:0 }
];

function pickRandom(arr, n) {
      const copy = [...arr];
      const result = [];
      for (let i = 0; i < n && copy.length > 0; i++) {
        const index = Math.floor(Math.random() * copy.length);
        result.push(copy.splice(index, 1)[0]);
      }
      return result;
    }

    const questions = [
      ...pickRandom(easyQuestions, 2),
      ...pickRandom(mediumQuestions, 2),
      ...pickRandom(hardQuestions, 1)
    ];

    let currentIndex = 0;
    let score = 0;
    let attempts = 0;
    let timer;
    let timeLeft = 15;
    let answered = false;

    const questionEl = document.getElementById("question");
    const optionsEl = document.getElementById("options");
    const scoreEl = document.getElementById("score");
    const timerEl = document.getElementById("timer");
    const playAgainContainer = document.getElementById("playAgainContainer");
const prevScore = localStorage.getItem("civilQuizScore");
const prevAttempts = localStorage.getItem("civilQuizAttempts");

if (prevScore && prevAttempts) {
  scoreEl.textContent = `Last Score: ${prevScore} | Attempts: ${prevAttempts}`;
}
function shuffleArray(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

    // ===== Timer =====
    function startTimer() {
      clearInterval(timer);
      timeLeft = 15;
      timerEl.textContent = timeLeft;
      timer = setInterval(() => {
        timeLeft--;
        timerEl.textContent = timeLeft;
       if (timeLeft <= 0) {
  clearInterval(timer);

  if (!answered) {
    answered = true;
    attempts++;
    scoreEl.textContent = `Score: ${score} | Attempts: ${attempts}`;
    showCorrectAnswer();
    setTimeout(nextQuestion, 1500);
  }
}
      }, 1000);
    }
function shuffleOptions(question) {
  const optionsWithIndex = question.options.map((opt, i) => ({
    text: opt,
    isCorrect: i === question.correct
  }));

  // Fisherâ€“Yates shuffle
  for (let i = optionsWithIndex.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [optionsWithIndex[i], optionsWithIndex[j]] =
    [optionsWithIndex[j], optionsWithIndex[i]];
  }

  question.options = optionsWithIndex.map(o => o.text);
  question.correct = optionsWithIndex.findIndex(o => o.isCorrect);
}

    // ===== Load Question =====
    function loadQuestion() {
      answered = false;
      const q = questions[currentIndex];
      shuffleOptions(q);
      optionsEl.innerHTML = "";
      questionEl.textContent = q.text;
      q.options.forEach((opt, i) => {
        const card = document.createElement("div");
        card.className = "card";
        const front = document.createElement("div");
        front.className = "face front";
        front.textContent = opt;
        const back = document.createElement("div");
        back.className = "face back";
        back.textContent = (i === q.correct) ? "Correct!" : "Wrong!";
        card.appendChild(front);
        card.appendChild(back);
        card.addEventListener("click", () => selectOption(card, i));
        optionsEl.appendChild(card);
      });
      startTimer();
    }
function showCorrectAnswer() {
  const q = questions[currentIndex];
  const cards = document.querySelectorAll(".card");

  cards.forEach((card, i) => {
    card.classList.add("flipped");
    const back = card.querySelector(".back");

    if (i === q.correct) {
      back.style.background = "green";
      back.textContent = "Correct!";
    } else {
      back.style.background = "red";
      back.textContent = "Wrong!";
    }
  });
}

    // ===== Select Option =====
function selectOption(selectedCard, index) {
  if (answered) return;
  answered = true;

  clearInterval(timer);
  attempts++;

  const correctIndex = questions[currentIndex].correct;
  if (index === correctIndex) score += 2;

  scoreEl.textContent = `Score: ${score} | Attempts: ${attempts}`;

  showCorrectAnswer();
  setTimeout(nextQuestion, 1500);
}


    // ===== Next Question =====
   function nextQuestion() {
  currentIndex++;

  if (currentIndex < questions.length) {
    loadQuestion();
  } else {
    questionEl.textContent =
      `Quiz Finished!
Final Score: ${score}
Attempts: ${attempts}`;

    optionsEl.innerHTML = "";
    timerEl.textContent = "";

    // ðŸ‘‡ SAVE DATA
    localStorage.setItem("civilQuizScore", score);
    localStorage.setItem("civilQuizAttempts", attempts);

    playAgainContainer.style.display = "block";
  }
}

    // ===== Go to Departments =====
    function goToDepartments() {
      window.location.href = "departments.html";
    }

    // ===== Start Quiz =====
    loadQuestion();
  </script>
</body>
</html>
